<?xml version="1.0" encoding="UTF-8"?>
<definitions xmlns="http://www.omg.org/spec/BPMN/20100524/MODEL"
             xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
             xmlns:bpmndi="http://www.omg.org/spec/BPMN/20100524/DI"
             xmlns:dc="http://www.omg.org/spec/DD/20100524/DC"
             xmlns:di="http://www.omg.org/spec/DD/20100524/DI"
             xmlns:camunda="http://camunda.org/schema/1.0/bpmn"
             id="Definitions_OperationalMaintenance"
             targetNamespace="http://bpmn.io/schema/bpmn">


 
  <process id="OperationalMaintenance_ProBuild"
           name="Operational External Maintenance – ProBuild"
           isExecutable="true">


    <startEvent id="Start_ProBuild" name="Start maintenance cycle"/>
    <endEvent id="End_ProBuild" name="Tools ready to hire"/>

   
    <userTask id="Task_RegisterTools"
              name="Register tools for external maintenance"
              camunda:assignee="warehouse_staff"/>

    <userTask id="Task_PrepareServiceBay"
              name="Prepare tools in Service Bay"
              camunda:assignee="warehouse_staff"/>

    <userTask id="Task_GenerateChecklist"
              name="Generate digital handover checklist"
              camunda:assignee="warehouse_supervisor"/>

    
    <sendTask id="Task_SendCollectionRequest"
              name="Send collection request to FixPro"
              camunda:type="external"
              camunda:topic="sendCollectionRequest"/>

    <receiveTask id="Task_ReceiveCompletionNotice"
                 name="Receive completion notice & service reports"/>

 
    <serviceTask id="Task_UpdateIMS"
                 name="Update internal tool management system (API sync)"
                 camunda:type="external"
                 camunda:topic="syncServiceData"/>

    <userTask id="Task_RescanAndRelocate"
              name="Rescan & relocate tools to Ready-to-Hire area"
              camunda:assignee="warehouse_staff"/>

  
    <sequenceFlow id="PB_Flow_1" sourceRef="Start_ProBuild" targetRef="Task_RegisterTools"/>
    <sequenceFlow id="PB_Flow_2" sourceRef="Task_RegisterTools" targetRef="Task_PrepareServiceBay"/>
    <sequenceFlow id="PB_Flow_3" sourceRef="Task_PrepareServiceBay" targetRef="Task_GenerateChecklist"/>
    <sequenceFlow id="PB_Flow_4" sourceRef="Task_GenerateChecklist" targetRef="Task_SendCollectionRequest"/>
    <sequenceFlow id="PB_Flow_5" sourceRef="Task_ReceiveCompletionNotice" targetRef="Task_UpdateIMS"/>
    <sequenceFlow id="PB_Flow_6" sourceRef="Task_UpdateIMS" targetRef="Task_RescanAndRelocate"/>
    <sequenceFlow id="PB_Flow_7" sourceRef="Task_RescanAndRelocate" targetRef="End_ProBuild"/>

 
    <intermediateCatchEvent id="Event_WaitForCompletion" name="Await FixPro completion">
      <incoming>PB_Flow_4</incoming>
      <outgoing>PB_Flow_8</outgoing>
    </intermediateCatchEvent>


    <sequenceFlow id="PB_Flow_8" sourceRef="Event_WaitForCompletion" targetRef="Task_ReceiveCompletionNotice"/>

   
    <dataObjectReference id="Data_PB_ToolRegister" name="Tool Register / Scan Log"/>
    <dataObjectReference id="Data_PB_HandoverChecklist" name="Digital Handover Checklist"/>
    <dataObjectReference id="Data_PB_ServiceReports" name="Service Reports from FixPro"/>
    <dataObjectReference id="Data_PB_IMSUpdate" name="IMS Update / Inventory Record"/>

  </process>

  
  <process id="OperationalMaintenance_FixPro"
           name="Operational External Maintenance – FixPro"
           isExecutable="true">

   
    <startEvent id="Start_FixPro" name="Collection request received"/>
    <endEvent id="End_FixPro" name="Service completed & reported"/>


    <receiveTask id="Task_ReceiveCollectionRequest"
                 name="Receive collection request from ProBuild"/>

    <userTask id="Task_ScheduleCollection"
              name="Schedule collection visit"
              camunda:assignee="fixpro_planner"/>

    <userTask id="Task_CollectTools"
              name="Collect tools from ProBuild"
              camunda:assignee="fixpro_driver"/>

   
    <subProcess id="SubProcess_ServiceTools" name="Service tools at FixPro facility">

      <startEvent id="Start_Service" name="Tools received at facility"/>
      <endEvent id="End_Service" name="Tools serviced & tested"/>

      <userTask id="Task_InitialInspection"
                name="Initial inspection & diagnostics"
                camunda:assignee="technician"/>

      <exclusiveGateway id="GW_ClassifyService" name="Routine / Repair / Decommission?"/>

      <userTask id="Task_RoutineService"
                name="Perform routine maintenance"
                camunda:assignee="technician"/>

      <userTask id="Task_RepairService"
                name="Perform repair"
                camunda:assignee="technician"/>

      <userTask id="Task_Decommission"
                name="Flag tool for decommissioning"
                camunda:assignee="technician"/>

  
      <serviceTask id="Task_ComplianceTesting"
                   name="Compliance testing & PAT"
                   camunda:type="external"
                   camunda:topic="runComplianceTests"/>

      <exclusiveGateway id="GW_CompliancePass" name="Compliance passed?"/>

  
      <sequenceFlow id="FX_Flow_1" sourceRef="Start_Service" targetRef="Task_InitialInspection"/>
      <sequenceFlow id="FX_Flow_2" sourceRef="Task_InitialInspection" targetRef="GW_ClassifyService"/>

      <sequenceFlow id="FX_Flow_3" sourceRef="GW_ClassifyService" targetRef="Task_RoutineService"/>
      <sequenceFlow id="FX_Flow_4" sourceRef="GW_ClassifyService" targetRef="Task_RepairService"/>
      <sequenceFlow id="FX_Flow_5" sourceRef="GW_ClassifyService" targetRef="Task_Decommission"/>

      <sequenceFlow id="FX_Flow_6" sourceRef="Task_RoutineService" targetRef="Task_ComplianceTesting"/>
      <sequenceFlow id="FX_Flow_7" sourceRef="Task_RepairService" targetRef="Task_ComplianceTesting"/>
      <sequenceFlow id="FX_Flow_8" sourceRef="Task_Decommission" targetRef="Task_ComplianceTesting"/>

      <sequenceFlow id="FX_Flow_9" sourceRef="Task_ComplianceTesting" targetRef="GW_CompliancePass"/>
      <sequenceFlow id="FX_Flow_10" sourceRef="GW_CompliancePass" targetRef="End_Service"/>

    </subProcess>

  
    <serviceTask id="Task_UpdatePortal"
                 name="Update FixPro client portal & generate reports"
                 camunda:type="external"
                 camunda:topic="updateClientPortal"/>

    <sendTask id="Task_SendCompletionNotice"
              name="Send completion notice & reports to ProBuild"
              camunda:type="external"
              camunda:topic="sendCompletionNotice"/>

  
    <sequenceFlow id="FP_Flow_1" sourceRef="Start_FixPro" targetRef="Task_ReceiveCollectionRequest"/>
    <sequenceFlow id="FP_Flow_2" sourceRef="Task_ReceiveCollectionRequest" targetRef="Task_ScheduleCollection"/>
    <sequenceFlow id="FP_Flow_3" sourceRef="Task_ScheduleCollection" targetRef="Task_CollectTools"/>
    <sequenceFlow id="FP_Flow_4" sourceRef="Task_CollectTools" targetRef="SubProcess_ServiceTools"/>
    <sequenceFlow id="FP_Flow_5" sourceRef="SubProcess_ServiceTools" targetRef="Task_UpdatePortal"/>
    <sequenceFlow id="FP_Flow_6" sourceRef="Task_UpdatePortal" targetRef="Task_SendCompletionNotice"/>
    <sequenceFlow id="FP_Flow_7" sourceRef="Task_SendCompletionNotice" targetRef="End_FixPro"/>

    <dataObjectReference id="Data_FX_ServiceSummary" name="Service Summary Report"/>
    <dataObjectReference id="Data_FX_Exceptions" name="Exceptions Report"/>
    <dataObjectReference id="Data_FX_ComplianceLabels" name="Compliance Labels"/>
    <dataObjectReference id="Data_FX_InvoiceData" name="Invoice / Cost Breakdown"/>

  </process>


  <collaboration id="Collaboration_OperationalMaintenance" name="ProBuild–FixPro Operational Collaboration">
    <participant id="Participant_ProBuild" processRef="OperationalMaintenance_ProBuild" name="ProBuild Supplies Ltd"/>
    <participant id="Participant_FixPro" processRef="OperationalMaintenance_FixPro" name="FixPro Ltd"/>

 
    <messageFlow id="MessageFlow_CollectionRequest"
                 name="Collection request"
                 sourceRef="Task_SendCollectionRequest"
                 targetRef="Task_ReceiveCollectionRequest"/>

    <messageFlow id="MessageFlow_CompletionNotice"
                 name="Completion notice & reports"
                 sourceRef="Task_SendCompletionNotice"
                 targetRef="Task_ReceiveCompletionNotice"/>
  </collaboration>

</definitions>
